# サーバー基本設計書

## 1. ドキュメント基本情報

| 項目 | 内容 |
|------|------|
| 作成日 | 2025年5月23日 |
| 作成者 | 堀内信英 |
| 対象システム | 社内業務アプリケーション基盤 |
| 対象サーバー | app-server01, db-server01 など |
| 利用開始予定日 | 2025年6月10日 |

---

## 2. サーバー構成概要

| サーバー名 | 用途 | OS | 役割 | 接続先 |
|------------|------|----|------|--------|
| app-server01 | アプリケーション | AlmaLinux 9.4 | Web/APIサーバー | db-server01 |
| db-server01 | データベース | AlmaLinux 9.4 | RDBMS（PostgreSQL） | app-server01 |
| fw01 | ファイアウォール | pfSense | 境界セキュリティ | 全体 |

---

## 3. システム構成図（別紙参照）

> ※ PlantUML または Draw.io などで別途作成し、リンクまたは添付。

---

## 4. 要件一覧

### 4.1 機能要件

| 番号 | 要件 | 詳細 |
|------|------|------|
| FR-01 | Webアプリ提供 | ユーザーがログインし申請処理が可能なこと |
| FR-02 | データ保存 | 入力データはDBに永続化されること |

### 4.2 非機能要件

| 番号 | 要件 | 詳細 |
|------|------|------|
| NFR-01 | 可用性 | 年間稼働率99.9%以上 |
| NFR-02 | 保守性 | OS/ミドルウェアは長期サポートバージョン使用 |
| NFR-03 | セキュリティ | 外部からのアクセスはHTTPS・VPN経由のみ許可 |

---

## 5. ネットワーク設計（概要）

| 項目 | 内容 |
|------|------|
| セグメント | 192.168.1.0/24（内部）、10.0.0.0/24（管理） |
| 通信制御 | firewalld、iptables、ルーターACL |
| 通信プロトコル | HTTP/HTTPS, SSH, PostgreSQL |
| ドメイン | localdomain.local |

---

## 6. ハードウェア設計（概要）

| 項目 | 内容 |
|------|------|
| サーバータイプ | 物理／仮想／クラウド（該当を選択） |
| CPU | 各サーバーで最低4コア以上 |
| メモリ | 16GB以上 |
| ストレージ | RAID1構成、最低500GB |
| 冗長性 | 電源・NICの冗長化あり |

---

## 7. ソフトウェア設計（概要）

| 種別 | ソフトウェア名 | バージョン | 備考 |
|------|----------------|------------|------|
| OS | AlmaLinux | 9.4 | SELinux有効 |
| Web | Apache HTTPD | 2.4.x | mod_ssl利用 |
| DB | PostgreSQL | 15.x | ローカル接続限定 |
| 言語 | Python | 3.11.x | FastAPI使用 |
| 監視 | Zabbix Agent | 最新 | 監視サーバ別途 |

---

## 8. 運用・保守設計（概要）

| 項目 | 内容 |
|------|------|
| バックアップ | DB: 毎日、設定: 毎週 |
| アラート監視 | CPU, メモリ, ストレージ, サービス死活 |
| 障害対応手順 | 30分以内に一次切り分け、24h以内に恒久対応 |
| ソフト更新 | 月1回パッチ適用＋年1回のメジャーアップデート |

---

## 9. セキュリティ設計（概要）

| 項目 | 対策内容 |
|------|-----------|
| アクセス制御 | 鍵認証、アクセス元IP制限 |
| Webセキュリティ | HTTPS化、CORS制御、CSRF対策 |
| DBセキュリティ | ローカル接続のみに制限、パスワードポリシー適用 |
| アカウント管理 | sudo可能ユーザー最小限、監査ログ保存 |

---

## 10. その他設計事項

- 内部DNSは構内専用のBIND構成
- 全サーバーは構築後にスナップショット取得
- 初期セットアップはAnsibleで自動化予定

